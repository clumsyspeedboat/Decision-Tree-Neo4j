library("ggplot2")
library("factoextra")
library("FSelector")
library("DescTools")
library("rpart")
library("rpart.plot")
library("C50")
library("RWeka")
TrainingSet = read.csv(file.choose(), header = TRUE, sep = ",")
TestingSet = read.csv(file.choose(), header = TRUE, sep = ",")
TrainingSet$age <- as.numeric(TrainingSet$age)
TrainingSet$anaemia <- as.factor(TrainingSet$anaemia)
TrainingSet$creatinine_phosphokinase <- as.numeric(TrainingSet$creatinine_phosphokinase)
TrainingSet$diabetes <- as.factor(TrainingSet$diabetes)
TrainingSet$ejection_fraction <- as.numeric(TrainingSet$ejection_fraction)
TrainingSet$high_blood_pressure <- as.factor(TrainingSet$high_blood_pressure)
TrainingSet$platelets <- as.numeric(TrainingSet$platelets)
TrainingSet$serum_creatinine <- as.numeric(TrainingSet$serum_creatinine)
TrainingSet$serum_sodium <- as.numeric(TrainingSet$serum_sodium)
TrainingSet$sex <- as.factor(TrainingSet$sex)
TrainingSet$smoking <- as.factor(TrainingSet$smoking)
TrainingSet$time <- as.numeric(TrainingSet$time)
TrainingSet$DEATH_EVENT <- as.factor(TrainingSet$DEATH_EVENT)
TestingSet$age <- as.numeric(TestingSet$age)
TestingSet$anaemia <- as.factor(TestingSet$anaemia)
TestingSet$creatinine_phosphokinase <- as.numeric(TestingSet$creatinine_phosphokinase)
TestingSet$diabetes <- as.factor(TestingSet$diabetes)
TestingSet$ejection_fraction <- as.numeric(TestingSet$ejection_fraction)
TestingSet$high_blood_pressure <- as.factor(TestingSet$high_blood_pressure)
TestingSet$platelets <- as.numeric(TestingSet$platelets)
TestingSet$serum_creatinine <- as.numeric(TestingSet$serum_creatinine)
TestingSet$serum_sodium <- as.numeric(TestingSet$serum_sodium)
TestingSet$sex <- as.factor(TestingSet$sex)
TestingSet$smoking <- as.factor(TestingSet$smoking)
TestingSet$time <- as.numeric(TestingSet$time)
TestingSet$DEATH_EVENT <- as.factor(TestingSet$DEATH_EVENT)
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'class', parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'cv', number = 10, parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
# Confusion Matrix #
levels <- levels(Prediction1)
levels <- levels[order(levels)]
cm1 <- table(ordered(Prediction1,levels), ordered(TestingSet$DEATH_EVENT, levels))
cm1
time_taken1 <- end.time1 -start.time1
time_taken2 <- end.time2 -start.time2
time_taken1
time_taken2
TrainingSet = read.csv(file.choose(), header = TRUE, sep = ",")
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'cv', number = 10, parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
start.time2 <- Sys.time()
Prediction1 <- predict(tree1, newdata=TestingSet,type = 'class')
end.time2 <- Sys.time()
time_taken1
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'cv', number = 10, parms = list(split = "gini"))
end.time1 <- Sys.time()
rpart.plot(tree1)
print(tree1)
time_taken1
summary(tree1)
library("caret")
Prediction1 <- confusionMatrix(tree1)
confusionMatrix(tree1)
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'cv', number = 10, parms = list(split = "gini"))
end.time1 <- Sys.time()
options(digits.secs = 6)
start.time1 <- Sys.time()
trC <- trainControl(method = "cv", number = 10, savePredictions = TRUE)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, trControl = trC, number = 10, split = "gini")
end.time1 <- Sys.time()
options(digits.secs = 6)
start.time1 <- Sys.time()
trC <- trainControl(method = "cv", number = 10, savePredictions = TRUE)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, trControl = trC, split = "gini")
end.time1 <- Sys.time()
options(digits.secs = 6)
start.time1 <- Sys.time()
trC <- trainControl(method = "cv", number = 10, savePredictions = TRUE)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, trControl = trC, split = "gini")
end.time1 <- Sys.time()
options(digits.secs = 6)
start.time1 <- Sys.time()
trC <- trainControl(method = "cv", number = 10, savePredictions = TRUE)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, trControl = trC, split = "gini")
end.time1 <- Sys.time()
options(digits.secs = 6)
start.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'cv', number = 10, parms = list(split = "gini"))
end.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'cv', number = 10, split = "gini")
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'cv', number = 10)
View(TrainingSet)
options(digits.secs = 6)
start.time1 <- Sys.time()
train.control <- trainControl(method = "cv", number = 10)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = 'cv', number = 10, trControl = train.control)
end.time1 <- Sys.time()
train.control <- trainControl(method = "cv", number = 10)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, number = 10, trControl = train.control)
options(digits.secs = 6)
start.time1 <- Sys.time()
train.control <- trainControl(method = "cv", number = 10)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = "tree", number = 10, trControl = train.control)
end.time1 <- Sys.time()
options(digits.secs = 6)
start.time1 <- Sys.time()
train.control <- trainControl(method = "cv", number = 10)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = "lm", number = 10, trControl = train.control)
end.time1 <- Sys.time()
options(digits.secs = 6)
start.time1 <- Sys.time()
train.control <- trainControl(method = "cv", number = 10)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = "class", number = 10, trControl = train.control)
end.time1 <- Sys.time()
options(digits.secs = 6)
start.time1 <- Sys.time()
train.control <- trainControl(method = "cv", number = 10)
tree1 <- rpart(DEATH_EVENT ~.,data=TrainingSet, method = "class", trControl = train.control)
end.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~,data=TrainingSet, method = "class", trControl = train.control)
train.control <- trainControl(method = "cv", number = 10)
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = "class", trControl = train.control)
options(digits.secs = 6)
start.time1 <- Sys.time()
train.control <- trainControl(method = "cv", number = 10)
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = "class", trControl = train.control, parms=list(split='gini'))
end.time1 <- Sys.time()
options(digits.secs = 6)
start.time1 <- Sys.time()
train.control <- trainControl(method = "cv", number = 10)
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = "class", trControl = train.control, parms=list(split="gini"))
end.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = "rpart", trControl = train.control, parms=list(split="gini"))
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = 'class', trControl = train.control, parms=list(split="gini"))
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, trControl = train.control, parms=list(split="gini"))
tree1 <- train(DEATH_EVENT ~. ,data=TrainingSet, method = 'class', trControl = train.control, parms=list(split="gini"))
tree1 <- train(DEATH_EVENT ~. ,data=TrainingSet, method = 'tree', trControl = train.control, parms=list(split="gini"))
tree1 <- train(DEATH_EVENT ~. ,data=TrainingSet, method = 'class', trControl = train.control, parms=list(split="gini"))
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = 'class', trControl = train.control, parms=list(split="gini"))
cat("\f")       # Clear old outputs
rm(list=ls())   # Clear all variables
if(!require("ggplot2")) install.packages("ggplot2")       # Visualization
if(!require("factoextra")) install.packages("factoextra") # PCA
if(!require("FSelector")) install.packages("FSelector")   # Information Gain & Gain Ratio
if(!require("DescTools")) install.packages("DescTools")   # Gini Index
if(!require("rpart")) install.packages("rpart")           # Decision Tree : CART (gini)
if(!require("rpart.plot")) install.packages("rpart.plot") # Decision Tree plot : CART
if(!require("C50")) install.packages("C50")               # Decision Tree : C 5.0 (gain ratio)
if(!require("RWeka")) install.packages("RWeka")           # Decision Tree : C 4.5 (gain ratio)
library("ggplot2")
library("factoextra")
library("FSelector")
library("DescTools")
library("rpart")
library("rpart.plot")
library("C50")
library("RWeka")
TrainingSet = read.csv(file.choose(), header = TRUE, sep = ",")
TrainingSet$age <- as.numeric(TrainingSet$age)
TrainingSet$anaemia <- as.factor(TrainingSet$anaemia)
TrainingSet$creatinine_phosphokinase <- as.numeric(TrainingSet$creatinine_phosphokinase)
TrainingSet$diabetes <- as.factor(TrainingSet$diabetes)
TrainingSet$ejection_fraction <- as.numeric(TrainingSet$ejection_fraction)
TrainingSet$high_blood_pressure <- as.factor(TrainingSet$high_blood_pressure)
TrainingSet$platelets <- as.numeric(TrainingSet$platelets)
TrainingSet$serum_creatinine <- as.numeric(TrainingSet$serum_creatinine)
TrainingSet$serum_sodium <- as.numeric(TrainingSet$serum_sodium)
TrainingSet$sex <- as.factor(TrainingSet$sex)
TrainingSet$smoking <- as.factor(TrainingSet$smoking)
TrainingSet$time <- as.numeric(TrainingSet$time)
TrainingSet$DEATH_EVENT <- as.factor(TrainingSet$DEATH_EVENT)
options(digits.secs = 6)
start.time1 <- Sys.time()
train.control <- trainControl(method = 'cv', number = 10)
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = 'class', trControl = train.control, parms=list(split="gini"))
end.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = 'rpart', trControl = train.control, parms=list(split="gini"))
source('C:/Users/49171/Desktop/Graph-Database-Learning-Algorithms-Neo4j/Dataset 1 - Heart Failure Prediction/Decision Tree Codes/(CART_C4.5_C 5.0)_&_Data_Analysis.R', echo=TRUE)
TrainingSet = read.csv(file.choose(), header = TRUE, sep = ",")
TrainingSet$age <- as.numeric(TrainingSet$age)
TrainingSet$anaemia <- as.factor(TrainingSet$anaemia)
TrainingSet$creatinine_phosphokinase <- as.numeric(TrainingSet$creatinine_phosphokinase)
TrainingSet$diabetes <- as.factor(TrainingSet$diabetes)
TrainingSet$ejection_fraction <- as.numeric(TrainingSet$ejection_fraction)
TrainingSet$high_blood_pressure <- as.factor(TrainingSet$high_blood_pressure)
TrainingSet$platelets <- as.numeric(TrainingSet$platelets)
TrainingSet$serum_creatinine <- as.numeric(TrainingSet$serum_creatinine)
TrainingSet$serum_sodium <- as.numeric(TrainingSet$serum_sodium)
TrainingSet$sex <- as.factor(TrainingSet$sex)
TrainingSet$smoking <- as.factor(TrainingSet$smoking)
TrainingSet$time <- as.numeric(TrainingSet$time)
TrainingSet$DEATH_EVENT <- as.factor(TrainingSet$DEATH_EVENT)
options(digits.secs = 6)
start.time1 <- Sys.time()
train.control <- trainControl(method = 'cv', number = 10)
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = 'rpart', trControl = train.control, parms=list(split="gini"))
end.time1 <- Sys.time()
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = "rpart", trControl = train.control, parms=list(split="gini"))
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = "rpart", trControl = train.control, parms=list(split="gini"))
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, type = "rpart", trControl = train.control, parms=list(split="gini"))
train.control <- trainControl(method = 'cv', number = 10)
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, type = "rpart", trControl = train.control, parms=list(split="gini"))
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, method = "cv", trControl = train.control, parms=list(split="gini"))
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, trControl = train.control, parms=list(split="gini"))
tree1 <- rpart(DEATH_EVENT ~. ,data=TrainingSet, trControl = train.control)
tree1 <- rpart(DEATH_EVENT ~. , method = "cv", type = "class", data=TrainingSet, trControl = train.control)
tree1 <- rpart(DEATH_EVENT ~. , data=TrainingSet, method = "cv", type = "class", trControl = train.control)
